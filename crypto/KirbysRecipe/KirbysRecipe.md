# Kirby's Recipe
Category: **Crypto** <br>
Points: **306**<br>
Original Challenge Author: **swan07**<br>
Writeup Author: **MoonCaller27**
## Problem Description
yum kirby
### downloads
[kirbysrecipe.zip](http://34.29.19.233/dl/?crypto/kirbys-recipe/kirbysrecipe.zip)
## Writeup
The contents of the file `index.html` from the ZIP file isn't too large, so I'll include it here: 
```
# Kirby's super duper soup recipe!!!

B Olmt ztl rm Wivzn Ozmw, R, Priyb, orevw drgs nb uznrob rm gsv kvzxvufo xlfmgibhrwv. Nb tizmwnlgsvi dzh z ivmldmvw ullw xsvu dsl szw xllpvw uli nzmb uznlfh svilvh zmw ilbzogb rm gsv ozmw.

V Hspxjoh vq, J mpwfe tqfoejoh ujnf xjui ifs jo uif ljudifo, xbudijoh ifs dppl vq efmjdjpvt nfbmt xjui johsfejfout tif ibe hspxo boe ibswftufe gspn ifs pxo gbsn. Tif xpvme bmxbzt tbz uibu dppljoh xbto'u kvtu bcpvu nbljoh gppe, cvu ju xbt bmtp bcpvu tipxjoh mpwf boe dbsf up uif qfpqmf zpv xfsf dppljoh gps.

Z Bar qnl, V jnf cynlvat bhgfvqr jvgu zl sevraqf jura V fnj zl tenaqzbgure jnyxvat gbjneqf hf, pneelvat n ynetr onfxrg shyy bs serfu irtrgnoyrf. Nf fur nccebnpurq, fur fzvyrq jnezyl naq vaivgrq hf vafvqr sbe n fanpx.

T Xifo xf hpu up uif ljudifo, tif cfhbo up dipq uif wfhfubcmft boe tbvu√© uifn jo b mbshf qpu. Uif bspnb pg uif wfhfubcmft dppljoh jo uif qpu xbt ifbwfomz, boe J dpvmeou xbju up ubtuf ju.

--- / .- ... / - .... . / ... --- ..- .--. / ... .. -- -- . .-. . -.. / -- -.-- / --. .-. .- -. -.. -- --- - .... . .-. / -... . --. .- -. / - --- / - . .-.. .-.. / ..- ... / .- -... --- ..- - / .... --- .-- / ... .... . / .-.. . .- .-. -. . -.. / - --- / -- .- -.- . / .. - .-.-.- / ... .... . / ... .- .. -.. / - .... .- - / .-- .... . -. / ... .... . / .-- .- ... / .- / -.-- --- ..- -. --. / -.-. .... . ..-. / ... .... . / .... .- -.. / - .-. .- ...- . .-.. . -.. / - --- / -- .- -. -.-- / -.. .. ..-. ..-. . .-. . -. - / .-.. .- -. -.. ... / - --- / .-.. . .- .-. -. / -. . .-- / -.-. --- --- -.- .. -. --. / - . -.-. .... -. .. --.- ..- . ... / .- -. -.. / .-. . -.-. .. .--. . ... .-.-.- / --- -. . / -.. .- -.-- / ... .... . / ... - ..- -- -... .-.. . -.. / ..- .--. --- -. / .- / ... -- .- .-.. .-.. / ...- .. .-.. .-.. .- --. . / .-- .... . .-. . / - .... . / .-.. --- -.-. .- .-.. ... / .-- . .-. . / -.- -. --- .-- -. / ..-. --- .-. / - .... . .. .-. / -.. . .-.. .. -.-. .. --- ..- ... / ...- . --. . - .- -... .-.. . / ... --- ..- .--. .-.-.-

01010101 00100000 01000001 01100110 01110100 01100101 01110010 00100000 01110100 01100001 01110011 01110100 01101001 01101110 01100111 00100000 01110100 01101000 01100101 00100000 01110011 01101111 01110101 01110000 00101100 00100000 01110011 01101000 01100101 00100000 01101011 01101110 01100101 01110111 00100000 01110011 01101000 01100101 00100000 01101000 01100001 01100100 00100000 01110100 01101111 00100000 01101100 01100101 01100001 01110010 01101110 00100000 01101000 01101111 01110111 00100000 01110100 01101111 00100000 01101101 01100001 01101011 01100101 00100000 01101001 01110100 00101110 00100000 01010011 01101000 01100101 00100000 01110011 01110000 01100101 01101110 01110100 00100000 01101101 01100001 01101110 01111001 00100000 01110111 01100101 01100101 01101011 01110011 00100000 01101001 01101110 00100000 01110100 01101000 01100101 00100000 01110110 01101001 01101100 01101100 01100001 01100111 01100101 00101100 00100000 01101100 01100101 01100001 01110010 01101110 01101001 01101110 01100111 00100000 01100110 01110010 01101111 01101101 00100000 01110100 01101000 01100101 00100000 01101100 01101111 01100011 01100001 01101100 01110011 00100000 01100001 01101110 01100100 00100000 01110000 01100101 01110010 01100110 01100101 01100011 01110100 01101001 01101110 01100111 00100000 01101000 01100101 01110010 00100000 01101111 01110111 01101110 00100000 01110010 01100101 01100011 01101001 01110000 01100101 00101110 00100000 01010111 01101000 01100101 01101110 00100000 01110011 01101000 01100101 00100000 01110010 01100101 01110100 01110101 01110010 01101110 01100101 01100100 00100000 01101000 01101111 01101101 01100101 00101100 00100000 01110011 01101000 01100101 00100000 01100001 01100100 01100100 01100101 01100100 00100000 01101000 01100101 01110010 00100000 01101111 01110111 01101110 00100000 01110011 01110000 01100101 01100011 01101001 01100001 01101100 00100000 01110100 01101111 01110101 01100011 01101000 01100101 01110011 00100000 01110100 01101111 00100000 01110100 01101000 01100101 00100000 01110010 01100101 01100011 01101001 01110000 01100101 00101100 00100000 01101101 01100001 01101011 01101001 01101110 01100111 00100000 01101001 01110100 00100000 01100101 01110110 01100101 01101110 00100000 01101101 01101111 01110010 01100101 00100000 01100100 01100101 01101100 01101001 01100011 01101001 01101111 01110101 01110011 00101110

UCBBcyB0aGUgc291cCB3YXMgcmVhZHksIG15IGdyYW5kbW90aGVyIGxhZGxlZCBpdCBpbnRvIGJvd2xzIGFuZCBoYW5kZWQgdGhlbSB0byB1cyB3aXRoIGEgc21pbGUuIEkgdG9vayBhIHNpcCBhbmQgd2FzIGJsb3duIGF3YXkgYnkgdGhlIGZsYXZvcnMuIEl0IHdhcyB0aGUgYmVzdCB2ZWdldGFibGUgc291cCBJIGhhZCBldmVyIHRhc3RlZC4gSSBhc2tlZCBteSBncmFuZG1vdGhlciBpZiBzaGUgY291bGQgdGVhY2ggbWUgaG93IHRvIG1ha2UgaXQsIGFuZCBzaGUgYWdyZWVkLiBLZXkgPSBLZXk=

WzE3NDc0LDE3MTYwLDQxMDI2LDYxMTkyLDUyMjkwLDU5MTQ0LDE2OTYyLDYwMTY4LDUzODI2LDUyNDg4LDE2OTYyLDU3MDk2LDUyMjkwLDYyMjE2LDU5OTcwLDE3MTYwLDUyODAyLDUyNDg4LDYxNTA2LDE3MTYwLDYxNTA2LDUyNDg4LDUyMjkwLDU1NTYwLDU5NDU4LDIzMzA0LDE2OTYyLDU2NTg0LDYyNTMwLDE3MTYwLDUzMzE0LDU5MTQ0LDUwMjQyLDU3MDk2LDUxNzc4LDU2NTg0LDU3NDEwLDYwMTY4LDUzODI2LDUyNDg4LDU4OTQ2LDE3MTYwLDU5OTcwLDUwNDQwLDYwNDgyLDUzNTEyLDUzODI2LDYwMTY4LDE2OTYyLDU2NTg0LDUyMjkwLDE3MTYwLDUzODI2LDU3NjA4LDYxNTA2LDE3MTYwLDU5OTcwLDU3NjA4LDE2OTYyLDU2NTg0LDUwMjQyLDU1NTYwLDUyMjkwLDE3MTYwLDU5OTcwLDU0MDI0LDUyMjkwLDE3MTYwLDU5NDU4LDU3NjA4LDYwNDgyLDU4MTIwLDE2OTYyLDUzMDAwLDU4OTQ2LDU3NjA4LDU2Mzg2LDE3MTYwLDU5NDU4LDUxNDY0LDU4OTQ2LDUwNDQwLDU5OTcwLDUxNDY0LDUzODI2LDI0MzI4LDE2OTYyLDQ1MzIwLDUyMjkwLDE3MTYwLDYxNTA2LDU3NjA4LDYwNDgyLDU2MDcyLDUxNzc4LDE3MTYwLDYxNTA2LDUwNDQwLDU1MzYyLDUyNDg4LDE2OTYyLDYwNjgwLDU3OTIyLDE3MTYwLDUyMjkwLDUwNDQwLDU4OTQ2LDU2MDcyLDYyNTMwLDE3MTYwLDU0MzM4LDU3MDk2LDE2OTYyLDYwMTY4LDUzODI2LDUyNDg4LDE2OTYyLDU2NTg0LDU3NDEwLDU5MTQ0LDU2ODk4LDU0NTM2LDU2ODk4LDUzNTEyLDE2OTYyLDYwMTY4LDU3NDEwLDE3MTYwLDUzODI2LDUwNDQwLDU4OTQ2LDYxMTkyLDUyMjkwLDU5NjU2LDU5OTcwLDE3MTYwLDUyODAyLDU5MTQ0LDUyMjkwLDU5NjU2LDUzODI2LDE3MTYwLDYwOTk0LDUyNDg4LDUzMzE0LDUyNDg4LDU5OTcwLDUwNDQwLDUwNzU0LDU2MDcyLDUyMjkwLDU5NjU2LDE2OTYyLDUzMDAwLDU4OTQ2LDU3NjA4LDU2Mzg2LDE3MTYwLDU5OTcwLDU0MDI0LDUyMjkwLDE3MTYwLDUzMzE0LDUwNDQwLDU4OTQ2LDUxOTc2LDUyMjkwLDU3MDk2LDIzMTA2LDE3MTYwLDUwMjQyLDU3MDk2LDUxNzc4LDE3MTYwLDU5NDU4LDU4MTIwLDUyMjkwLDU3MDk2LDUxNzc4LDE3MTYwLDU5OTcwLDU0MDI0LDUyMjkwLDE3MTYwLDUxNzc4LDUwNDQwLDYyNTMwLDE3MTYwLDUxMjY2LDU3NjA4LDU3NDEwLDU1NTYwLDU0MzM4LDU3MDk2LDUzMzE0LDE3MTYwLDUwMjQyLDU3MDk2LDUxNzc4LDE3MTYwLDU3OTIyLDU5MTQ0LDUyMjkwLDU4MTIwLDUwMjQyLDU5MTQ0LDU0MzM4LDU3MDk2LDUzMzE0LDE3MTYwLDU5OTcwLDU0MDI0LDUyMjkwLDE3MTYwLDU5NDU4LDU3NjA4LDYwNDgyLDU4MTIwLDI0MTMwLDE3MTYwLDQzMDc0LDU0MDI0LDUyMjkwLDE3MTYwLDU5NDU4LDU0MDI0LDU3NDEwLDYxNzA0LDUyMjkwLDUxOTc2LDE2OTYyLDU2NTg0LDUyMjkwLDE3MTYwLDUzODI2LDU3NjA4LDYxNTA2LDE3MTYwLDU5OTcwLDU3NjA4LDE2OTYyLDUxNDY0LDUzODI2LDU3NjA4LDU3OTIyLDE3MTYwLDU5OTcwLDU0MDI0LDUyMjkwLDE3MTYwLDYwOTk0LDUyNDg4LDUzMzE0LDUyNDg4LDU5OTcwLDUwNDQwLDUwNzU0LDU2MDcyLDUyMjkwLDU5NjU2LDE2OTYyLDU1MDQ4LDYwNDgyLDU5NjU2LDU5OTcwLDE3MTYwLDU4OTQ2LDU0NTM2LDUzMzE0LDU0MDI0LDU5OTcwLDE3MTYwLDUwMjQyLDU3MDk2LDUxNzc4LDE3MTYwLDUzODI2LDU3NjA4LDYxNTA2LDE3MTYwLDU5OTcwLDU3NjA4LDE2OTYyLDU5NjU2LDUyMjkwLDUwNDQwLDU5NDU4LDU3NjA4LDU2ODk4LDE3MTYwLDU5OTcwLDU0MDI0LDUyMjkwLDE3MTYwLDU5NDU4LDU3NjA4LDYwNDgyLDU4MTIwLDE2OTYyLDYwMTY4LDU3NDEwLDE3MTYwLDU3OTIyLDUyNDg4LDU4OTQ2LDUzMDAwLDUyMjkwLDUxNDY0LDU5OTcwLDU0NTM2LDU3NDEwLDU3MDk2LDI0MTMwLDE3MTYwLDM4OTc4LDUyNDg4LDYyNTMwLDE3MTYwLDMxODEwLDE3MTYwLDI1NjY2XQ==

!@r!H!fsdv!nmeds-!H!bnouhotde!un!l`jd!uid!rntq-!q`rrhof!no!uid!sdbhqd!un!lx!nvo!gshdoer!`oe!g`lhmx/!@oe!vidodwds!H!bnnjde!hu-!H!`mv`xr!uintfiu!ng!lx!fs`oelnuids!`oe!uid!ldlnshdr!vd!ri`sde!ho!uid!jhubido/!Un!uihr!e`x-!vidodwds!H!l`jd!uid!rntq-!H!b`o&u!idmq!ctu!rlhmd-!jonvhof!ui`u!H!`l!b`ssxhof!no!`!us`ehuhno!ui`u!ru`sude!vhui!lx!fs`oelnuids!ho!uid!bntousxrhed!ng!Esd`l!M`oe/

## Ingredients

-   1 tablespoon olive oil
-   1 onion, chopped
-   2 garlic cloves, minced
-   1 pound carrots, peeled and sliced
-   4 cups vegetable broth
-   1 teaspoon dried thyme
-   1/2 teaspoon salt
-   1/4 teaspoon black pepper
-   1/2 cup heavy cream

## Instructions

1.  In a large pot, heat the olive oil over medium heat.
2.  Add the chopped onion and minced garlic, and cook until softened.
3.  Add the sliced carrots, vegetable broth, dried thyme, salt, and pepper. Bring to a boil, then reduce heat and simmer for 15 to 20 minutes, or until the carrots are tender.
4.  Use an immersion blender to puree the soup until smooth.
5.  Stir in the heavy cream and heat through.
6.  Serve hot, and enjoy.
```
Upon opening this up, we can see a lot of different ciphers. Since we don't know what these ciphers could mean, we can use a [cipher identifier](https://www.dcode.fr/cipher-identifier) to figure out the ciphers each are.
### The ciphers in order:
**1. Atbash Cipher**. <br><br>
The result we get from decrypting the atbash:<br>
`
Y Long ago in Dream Land, I, Kirby, lived with my family in the peaceful countryside. My grandmother was a renowned food chef who had cooked for many famous heroes and royalty in the land.`<br><br>
**2. ROT1 Cipher**. <br><br>
The result we get from decrypting the ROT1:<br>
`U Growing up, I loved spending time with her in the kitchen, watching her cook up delicious meals with ingredients she had grown and harvested from her own farm. She would always say that cooking wasn't just about making food, but it was also about showing love and care to the people you were cooking for.`<br><br>
**3. ROT-13 Cipher**<br><br>
The result we get from decrypting the ROT-13:<br>
`M One day, I was playing outside with my friends when I saw my grandmother walking towards us, carrying a large basket full of fresh vegetables. As she approached, she smiled warmly and invited us inside for a snack.`<br><br>
**4. ROT-1 Cipher**<br><br>
The result we get from decrypting the ROT-1:<br>
`S When we got to the kitchen, she began to chop the vegetables and sautd them in a large pot. The aroma of the vegetables cooking in the pot was heavenly, and I couldnt wait to taste it.`<br><br>
**5. Morse Code**<br><br>
The result we get after decrypting the morse code:<br>
`O AS THE SOUP SIMMERED MY GRANDMOTHER BEGAN TO TELL US ABOUT HOW SHE LEARNED TO MAKE IT. SHE SAID THAT WHEN SHE WAS A YOUNG CHEF SHE HAD TRAVELED TO MANY DIFFERENT LANDS TO LEARN NEW COOKING TECHNIQUES AND RECIPES. ONE DAY SHE STUMBLED UPON A SMALL VILLAGE WHERE THE LOCALS WERE KNOWN FOR THEIR DELICIOUS VEGETABLE SOUP.`<br><br>
**6. ASCII Code (Binary)**<br><br>
The result we get after decrypting the ASCII code:<br>
`U After tasting the soup, she knew she had to learn how to make it. She spent many weeks in the village, learning from the locals and perfecting her own recipe. When she returned home, she added her own special touches to the recipe, making it even more delicious.`<br>
**7. Base64**<br><br>
The result we get after decrypting the Base64 code:<br>
`P As the soup was ready, my grandmother ladled it into bowls and handed them to us with a smile. I took a sip and was blown away by the flavors. It was the best vegetable soup I had ever tasted. I asked my grandmother if she could teach me how to make it, and she agreed. Key = Key`<br>
Interesting, it seems like we have something that isn't part of the story! At the very end we see that `Key=Key`, hmm....<br><br>

**The next two ciphers are trickier, since they can't be found directly through the cipher identifier**. 
### ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èWARNING‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è
**For these last two ciphers, if you are to use the ciphers that the cipher identifier gives you, you will not be able to find the solution.**
### ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏èWARNING‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è
**8. Bit Shift Cipher**
This cipher doesn't seem to have a clear solution at the start, but after further examination, we can see the `==` at the end. Which ciphers are characteristic of this? Base ciphers! (`Base64, Base58, Base32, etc.`) However, when we try to use these ciphers, they don't end up working. So, we remember bases and the other thing we think of is `bits`. Luckily, there is a cipher called the `Bit Shift Cipher`. We can use this [decrypter](https://www.cryptool.org/en/cto/bitshift) with the key from the last cipher (`Key=Key`) to get:<br>
`! Over the next few weeks, my grandmother taught me how to make the soup from scratch. We would wake up early in the morning to harvest fresh vegetables from the garden, and spend the day cooking and preparing the soup. She showed me how to chop the vegetables just right and how to season the soup to perfection. Key = 1`<br>
We see another key, so we move on to the next cipher.<br><br>
**9.** For this last cipher, we can use two different methods:<br>
**Method #1**: First, we need to be careful of the hidden whitespace character at the very beginning when we use `Inspect Element` to look at the source code. After that, we can try out different ciphers until we finally get that this cipher is the **XOR Cipher**.  Decoding the [XOR cipher](https://www.cryptool.org/en/cto/xor) using a key of 1 gives:<br>
`! As I grew older, I continued to make the soup, passing on the recipe to my own friends and family. And whenever I cooked it, I always thought of my grandmother and the memories we shared in the kitchen. To this day, whenever I make the soup, I can'lq:t help but smile, knowing that I am carrying on a tradition that started with my grandmother in the countryside of Dream Land.`<br><br>
Now from here, we notice that each of the decoded lines has a character in front, and when we add all of them up, we get `YUMSOUP!!`<br> 
**Method #2:** If you maybe tried to find the cipher and couldn't find it, brute forcing is another option. Since we already know 6 of the 7 characters of the special keyword (`YUMSOUP!`), we can just head straight to the `kirbycooking.png.zip` file and just bash out the password until you find the correct one. Eventually, you will end up with the correct password of `YUMSOUP!!`<br><br>

Now that we know the password, we can open up the `.png` file. But we're not sure what to do with this file! Perhaps we could use something called steganography (hiding information within an image). After extracting the file from the folder and decrypting using [this website](https://stylesuxx.github.io/steganography/), we find the flag instantly in the `Hidden Message` field.
<br> Flag: `LITCTF{s0up_fr0m_k1rby!2!3}`
